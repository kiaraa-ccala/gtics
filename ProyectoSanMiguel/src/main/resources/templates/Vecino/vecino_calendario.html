<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
  <!-- [Head] start -->

  <head th:replace="fragments/head_vecino :: head('Agregar Usuario')"></head>

  <body data-pc-preset="preset-1" data-pc-sidebar-caption="true" data-pc-layout="vertical" data-pc-direction="ltr" data-pc-theme_contrast="" data-pc-theme="light">
    <!-- [ Pre-loader ] start -->
  <div class="loader-bg">
    <div class="loader-track">
      <div class="loader-fill"></div>
    </div>
  </div>

    <div th:replace="fragments/Sidebar_vecino :: sidebar"></div>


    <div th:replace="fragments/navbar_vecino :: header"></div>
    
    <!-- [ Main Content ] start -->
    <div class="pc-container" style="background: #e0f6ff">
      <div class="pc-content">
        <!-- [ breadcrumb ] start -->
        <div class="page-header">
          <div class="page-block">
            <div class="row align-items-center">
              <div class="col-md-12">
                <ul class="breadcrumb">
                  <li class="breadcrumb-item"><a href="../dashboard/index.html">Inicio</a></li>
                  <li class="breadcrumb-item" aria-current="page">Calendario</li>
                </ul>
              </div>
              <div class="col-md-12">
                <div class="page-header-title">
                  <h2 class="mb-0">Calendario</h2>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!-- [ breadcrumb ] end -->


        <div class="row">
          <!-- [ sample-page ] start -->
          <div class="col-12">
            <div class="card">
              <div class="card-body position-relative">
                <div id="calendar" class="calendar"></div>
              </div>
            </div>
          </div>
          <!-- [ sample-page ] end -->
        </div>
        <!-- [ Main Content ] end -->
      </div>
    </div>

    <div class="modal fade" id="calendar-modal" data-bs-keyboard="false" tabindex="-1" aria-hidden="true">
      <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="calendar-modal-title f-w-600 text-truncate">Modal title</h3>
            <a href="#" class="avtar avtar-s btn-link-danger btn-pc-default ms-auto" data-bs-dismiss="modal">
              <i class="ti ti-x f-20"></i>
            </a>
          </div>
          <div class="modal-body">
            <div class="d-flex">
              <div class="flex-shrink-0">
                <div class="avtar avtar-xs bg-light-secondary">
                  <i class="ti ti-heading f-20"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <h5 class="mb-1"><b>Title</b></h5>
                <p class="pc-event-title text-muted"></p>
              </div>
            </div>
            <div class="d-flex">
              <div class="flex-shrink-0">
                <div class="avtar avtar-xs bg-light-warning">
                  <i class="ti ti-map-pin f-20"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <h5 class="mb-1"><b>Venue</b></h5>
                <p class="pc-event-venue text-muted"></p>
              </div>
            </div>
            <div class="d-flex">
              <div class="flex-shrink-0">
                <div class="avtar avtar-xs bg-light-danger">
                  <i class="ti ti-calendar-event f-20"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <h5 class="mb-1"><b>Date</b></h5>
                <p class="pc-event-date text-muted"></p>
              </div>
            </div>
            <div class="d-flex">
              <div class="flex-shrink-0">
                <div class="avtar avtar-xs bg-light-primary">
                  <i class="ti ti-file-text f-20"></i>
                </div>
              </div>
              <div class="flex-grow-1 ms-3">
                <h5 class="mb-1"><b>Description</b></h5>
                <p class="pc-event-description text-muted"></p>
              </div>
            </div>
          </div>
          <div class="modal-footer justify-content-between">
            <ul class="list-inline me-auto mb-0">
              <li class="list-inline-item align-bottom">
                <a
                  href="#"
                  id="pc_event_remove"
                  class="avtar avtar-s btn-link-danger btn-pc-default w-sm-auto"
                  data-bs-toggle="tooltip"
                  title="Delete"
                >
                  <i class="ti ti-trash f-18"></i>
                </a>
              </li>
              <li class="list-inline-item align-bottom">
                <a href="#" id="pc_event_edit" class="avtar avtar-s btn-link-success btn-pc-default" data-bs-toggle="tooltip" title="Edit">
                  <i class="ti ti-edit-circle f-18"></i>
                </a>
              </li>
            </ul>
            <div class="flex-grow-1 text-end">
              <button type="button" class="btn btn-primary" data-bs-dismiss="modal">Close</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="offcanvas offcanvas-end cal-event-offcanvas" tabindex="-1" id="calendar-add_edit_event">
      <div class="offcanvas-header">
        <h3 class="f-w-600 text-truncate">Add Events</h3>
        <a href="#" class="avtar avtar-s btn-link-danger btn-pc-default ms-auto" data-bs-dismiss="offcanvas">
          <i class="ti ti-x f-20"></i>
        </a>
      </div>
      <div class="offcanvas-body">
        <form id="pc-form-event" novalidate>
          <div class="mb-3">
            <label class="form-label">Title</label>
            <input type="email" class="form-control" id="pc-e-title" placeholder="Enter event title" autofocus />
          </div>
          <div class="mb-3">
            <label class="form-label">Venue</label>
            <input type="email" class="form-control" id="pc-e-venue" placeholder="Enter event venue" />
          </div>
          <div>
            <input type="hidden" class="form-control" id="pc-e-sdate" />
            <input type="hidden" class="form-control" id="pc-e-edate" />
          </div>
          <div class="mb-3">
            <label class="form-label">Description</label>
            <textarea class="form-control" placeholder="Enter event description" rows="3" id="pc-e-description"></textarea>
          </div>
          <div class="mb-3">
            <label class="form-label">Type</label>
            <select class="form-select" id="pc-e-type">
              <option value="empty" selected>Type</option>
              <option value="event-primary">Primary</option>
              <option value="event-secondary">Secondary</option>
              <option value="event-success">Success</option>
              <option value="event-danger">Danger</option>
              <option value="event-warning">Warning</option>
              <option value="event-info">Info</option>
            </select>
          </div>
          <div class="row justify-content-between">
            <div class="col-auto"
              ><button type="button" class="btn btn-link-danger btn-pc-default" data-bs-dismiss="offcanvas"
                ><i class="align-text-bottom me-1 ti ti-circle-x"></i> Close</button
              ></div
            >
            <div class="col-auto">
              <button id="pc_event_add" type="button" class="btn btn-secondary" data-pc-action="add">
                <span id="pc-e-btn-text"><i class="align-text-bottom me-1 ti ti-calendar-plus"></i> Add</span>
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>

    <!-- [ Main Content ] end -->
    <footer class="pc-footer" style="background: #e0f6ff">
      <div class="footer-wrapper container-fluid">
        <div class="row">
          <div class="col my-1">
            <p class="m-0">
              © Copyright 2025 | Municipalidad de San Miguel. Una gestión diferente</p>
          </div>

        </div>
      </div>
    </footer>
 <!-- Required Js -->
    <script th:src="@{/assets/js/plugins/popper.min.js}"></script>
    <script th:src="@{/assets/js/plugins/simplebar.min.js}"></script>
    <script th:src="@{/assets/js/plugins/bootstrap.min.js}"></script>

    <script th:src="@{/assets/js/plugins/i18next.min.js}"></script>
    <script th:src="@{/assets/js/plugins/i18nextHttpBackend.min.js}"></script>

    <script th:src="@{/assets/js/icon/custom-font.js}"></script>
    <script th:src="@{/assets/js/script.js}"></script>
    <script th:src="@{/assets/js/theme.js}"></script>
    <script th:src="@{/assets/js/multi-lang.js}"></script>
    <script th:src="@{/assets/js/plugins/feather.min.js}"></script>



<script>
  layout_change('light');
</script>
  
<script>
  change_box_container('false');
</script>
 
<script>
  layout_caption_change('true');
</script>
 
<script>
  layout_rtl_change('false');
</script>
 
<script>
  preset_change('preset-1');
</script>
 
<script>
  main_layout_change('vertical');
</script>


    <!-- [Page Specific JS] start -->
    <!-- calender js -->
    <script th:src="@{/assets/js/plugins/index.global.min.js}"></script>
    <!-- Sweet Alert -->
    <script th:src="@{/assets/js/plugins/sweetalert2.all.min.js}"></script>
    <script th:src="@{/assets/js/application/calendar.js}"></script>
    <!-- [Page Specific JS] end -->

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const calendarEl = document.getElementById('calendar');
        const form = document.getElementById('pc-form-event');

        // Función para sumar 1 día (JS nativo)
        function addOneDay(dateStr) {
          const date = new Date(dateStr);
          date.setDate(date.getDate() + 1);
          return date.toISOString().split('T')[0];
        }

        const calendar = new FullCalendar.Calendar(calendarEl, {
          initialView: 'dayGridMonth',
          locale: 'es',
          editable: true,        // mover eventos
          selectable: true,      // seleccionar fechas
          eventResizableFromStart: true, // redimensionar desde el inicio también
          headerToolbar: {
            left: 'prev,next today',
            center: 'title',
            right: 'dayGridMonth,timeGridWeek,timeGridDay'
          },

          dateClick: function (info) {
            // Rellenar los campos ocultos del formulario con la fecha
            document.getElementById('pc-e-sdate').value = info.dateStr;
            document.getElementById('pc-e-edate').value = info.dateStr;
            const offcanvas = new bootstrap.Offcanvas('#calendar-add_edit_event');
            offcanvas.show();
          },

          eventClick: function (info) {
            alert(`Evento: ${info.event.title}`);
            // Aquí puedes implementar lógica de edición si quieres
          },

          eventDrop: function (info) {
            console.log(`Evento movido a: ${info.event.startStr}`);
            // Aquí podrías actualizar en base de datos si fuera necesario
          },

          eventResize: function (info) {
            console.log(`Evento redimensionado: ${info.event.startStr} -> ${info.event.endStr}`);
            // Aquí también puedes actualizar datos
          }
        });

        calendar.render();

        // Botón "Agregar evento"
        document.getElementById('pc_event_add').addEventListener('click', function () {
          const title = document.getElementById('pc-e-title').value;
          const start = document.getElementById('pc-e-sdate').value;
          const end = addOneDay(start); // evento de 1 día que se puede redimensionar
          const description = document.getElementById('pc-e-description').value;
          const type = document.getElementById('pc-e-type').value;

          if (title && start) {
            calendar.addEvent({
              title: title,
              start: start,
              end: end,
              description: description,
              classNames: [type]
            });

            // Cierra offcanvas y limpia formulario
            const offcanvasEl = document.getElementById('calendar-add_edit_event');
            const offcanvasInstance = bootstrap.Offcanvas.getInstance(offcanvasEl);
            offcanvasInstance.hide();
            form.reset();
          } else {
            alert('Por favor, completa el título y la fecha');
          }
        });
      });
    </script>





    <style>
      #basic-btn_info {
        display: none !important;
      }

      /* Ítems del menú: blanco */
      .pc-sidebar .pc-link,
      .pc-sidebar .pc-mtext,
      .pc-sidebar .pc-micon {
        color: #ffffff !important;
        opacity: 1 !important;
      }

      /* Títulos de secciones del menú */
      .pc-sidebar .menu-caption,
      .pc-sidebar .pc-caption {
        color: rgba(255, 255, 255, 0.6) !important;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 12px;
      }
      /* Hover: cambia el texto a celeste claro */
      .pc-sidebar .pc-link:hover,
      .pc-sidebar .pc-link:focus {
        background-color: rgba(255, 255, 255, 0.05); /* Fondo sutil */
        transition: all 0.2s ease-in-out;
      }
    </style>

  </body>
  <!-- [Body] end -->
</html>
